<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <link type="text/css" rel="stylesheet" href="../libs/qunit.css"/>
    <script type="text/javascript" src="../libs/jquery-1.11.0.js"></script>
    <script type="text/javascript" src="../libs/qunit.js"></script>
    <script type="text/javascript">
        module("duration format");
        function formatDuration(seconds) {
            if (seconds == 0) {
                return "now";
            }

            var forms = ['', 's'];
            var units = ['year', 'month', 'day', 'hour', 'minute', 'second'];
            var rates = [365 * 24 * 60 * 60, 30 * 24 * 60 * 60, 24 * 60 * 60, 60 * 60, 60, 1];
            var parts = [];
            for (var which = 0; which < rates.length; which++) {
                var part = ~~(seconds / rates[which]);
                if (!part) {
                    continue;
                }
                var unit = units[which] + forms[+(part > 1)];
                seconds -= part * rates[which];
                parts.push([ part, unit].join(' '));
            }
            return parts.join(' and ');

        }

        test('now', function () {
            equal(formatDuration(0), 'now');
        });

        test('one singular unit', function () {
            equal(formatDuration(1), "1 second");
            equal(formatDuration(60), "1 minute");
            equal(formatDuration(60 * 60), "1 hour");
            equal(formatDuration(24 * 60 * 60), "1 day");
            equal(formatDuration(30 * 24 * 60 * 60), "1 month");
            equal(formatDuration(365 * 24 * 60 * 60), "1 year");
        });

        test('one plural unit', function () {
            equal(formatDuration(2), "2 seconds");
            equal(formatDuration(2 * 60), "2 minutes");
            equal(formatDuration(2 * 60 * 60), "2 hours");
        });

        test('two last units', function () {
            equal(formatDuration(61), "1 minute and 1 second");
        });

    </script>
</head>
<body>
<div id="qunit"></div>
</body>
</html>
